// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlserver"
  url      = env("DATABASE_URL")
}

// kod | isim | plasiyer | bakiye | ciro
model Cari {
  kod          String        @id
  unvan        String
  bakiye       Float
  sektor       String?
  temsilci_kod String?
  temsilci     Temsilci?     @relation(fields: [temsilci_kod], references: [kod])
  SiparisOzet  SiparisOzet[]
  Siparis      Siparis[]

  @@map("CRM_CARI_HESAPLAR")
}

model Stok {
  kod       String  @id @map("sto_kod")
  isim      String  @map("sto_isim")
  birim     String? @map("sto_birim1_ad")
  marka_kod String? @map("sto_marka_kodu")
  kdv       String? @map("sto_muhgrup_kodu")

  marka   Marka?       @relation(fields: [marka_kod], references: [kod], onDelete: NoAction, onUpdate: NoAction)
  miktar  StokMiktar   @relation(fields: [kod], references: [stok_kod], onDelete: NoAction, onUpdate: NoAction)
  siparis Siparis[]
  fiyat   FiyatListe[]

  @@map("STOKLAR")
}

model FiyatListe {
  stok_kod String @map("sfiyat_stokkod")
  liste_no Int    @map("sfiyat_listesirano")
  fiyat    Float  @map("sfiyat_fiyati")

  stok Stok @relation(fields: [stok_kod], references: [kod])

  @@unique([stok_kod, liste_no, fiyat])
  @@map("STOK_SATIS_FIYAT_LISTELERI")
}

model StokMiktar {
  stok_kod  String @id @map("sto_kod")
  merkez    Float
  balikesir Float
  istanbul  Float
  Stok      Stok[]

  @@map("CRM_STOK_DEPO_MIKTARLARI")
}

model Marka {
  kod  String @id @map("mrk_kod")
  isim String @map("mrk_ismi")
  Stok Stok[]

  @@map("STOK_MARKALARI")
}

// kod | isim | mevcutMiktar | birimFiyat
// model Fiyatlar {}
model Temsilci {
  kod         String        @id @map("cari_per_kod")
  ad          String        @map("cari_per_adi")
  soyad       String        @map("cari_per_soyadi")
  tel         String?       @map("cari_per_cepno")
  eposta      String?       @map("cari_per_mail")
  tip         Int           @map("cari_per_tip")
  Cari        Cari[]
  SiparisOzet SiparisOzet[]

  @@map("CARI_PERSONEL_TANIMLARI")
}

model Depo {
  id          Int           @id @map("dep_no")
  isim        String        @map("dep_adi")
  tip         Int           @map("dep_tipi")
  eposta      String?       @map("dep_yetkili_email")
  SiparisOzet SiparisOzet[]

  @@map("DEPOLAR")
}

//
model CariHareket {
  id               String    @unique
  tarih            DateTime? @db.DateTime
  evrak_seri       String?
  evrak_sira       Int?
  cari_kod         String
  evrak_tip        String?
  evrak_cinsi      String?
  normal_iade      String
  vade_tarihi      DateTime? @db.DateTime
  vade_gun         Int?
  borc_alacak      String
  ana_doviz_borc   Float
  ana_doviz_alacak Float

  @@map("CRM_CARI_HESAP_HAREKETLERI")
}

model SiparisOzet {
  tarih            DateTime @db.DateTime
  evrak_seri       String
  evrak_sira       Int
  satir_sayisi     Int
  depo_kod         Int
  cari_kod         String
  temsilci_kod     String
  odeme_plan_kod   Int?
  proje            String?
  miktar           Float
  miktar_teslim    Float
  miktar_kalan     Float
  tutar            Float
  tutar_net        Float
  onay             String
  durum            String
  olusturma_tarihi DateTime @db.DateTime
  fileId           Int      @default(21)

  cari       Cari       @relation(fields: [cari_kod], references: [kod], onDelete: NoAction, onUpdate: NoAction)
  temsilci   Temsilci   @relation(fields: [temsilci_kod], references: [kod], onDelete: NoAction, onUpdate: NoAction)
  depo       Depo       @relation(fields: [depo_kod], references: [id], onDelete: NoAction, onUpdate: NoAction)
  odeme_plan OdemePlan? @relation(fields: [odeme_plan_kod], references: [id])
  stoklar    Siparis[]
  aciklama   Aciklama?

  @@id([evrak_seri, evrak_sira, tarih])
  @@unique([evrak_seri, evrak_sira, tarih])
  @@unique([evrak_seri, evrak_sira, fileId])
  @@map("CRM_SIPARISLER_OZET")
}

model OdemePlan {
  id          Int    @id @map("odp_no")
  isim        String @map("odp_adi")
  iskonto_kod Int    @map("odp_special1")

  iskonto     Iskonto       @relation(fields: [iskonto_kod], references: [id], onDelete: NoAction, onUpdate: NoAction)
  SiparisOzet SiparisOzet[]

  @@map("ODEME_PLANLARI")
}

model Iskonto {
  id        Int         @id @map("crm_isk_kod")
  isim      String      @map("crm_isk_isim")
  aciklama  String      @map("crm_isk_aciklama")
  oran      Float       @map("crm_isk_oran")
  OdemePlan OdemePlan[]

  @@map("CRM_ISKONTO_TANIMLAMALARI")
}

model Siparis {
  id                           String   @id @map("sip_Guid")
  tarih                        DateTime @map("sip_belge_tarih") @db.DateTime
  evrak_seri                   String   @default("") @map("sip_evrakno_seri")
  evrak_sira                   Int      @map("sip_evrakno_sira")
  satirno                      Int      @map("sip_satirno")
  olusturan_kod                Int      @map("sip_create_user")
  temsilci_kod                 String   @map("sip_satici_kod")
  cari_kod                     String   @map("sip_musteri_kod")
  stok_kod                     String   @map("sip_stok_kod")
  birim_fiyat                  Float    @map("sip_b_fiyat")
  miktar                       Float    @default(1.0) @map("sip_miktar")
  miktar_tamamlanan            Float    @default(0) @map("sip_teslim_miktar")
  tutar                        Float    @map("sip_tutar")
  iskonto                      Float    @default(0) @map("sip_iskonto_1")
  vergi                        Float    @map("sip_vergi")
  odeme_plan_kod               Int      @map("sip_opno")
  aciklama                     String   @default("") @map("sip_aciklama")
  depo_kod                     Int      @map("sip_depono")
  onaylayan_kod                Int      @default(0) @map("sip_OnaylayanKulNo")
  durum                        Int      @default(0) @map("sip_durumu") // TODO: durum için varsayılan değer kontrol edilecek
  sip_lastup_user              Int
  sip_tarih                    DateTime @db.DateTime
  sip_teslim_tarih             DateTime @db.DateTime
  doviz_cinsi                  Int      @default(0) @map("sip_doviz_cinsi")
  doviz_kuru                   Float    @default(1) @map("sip_doviz_kuru")
  alternatif_doviz_kuru        Float    @map("sip_alt_doviz_kuru")
  sip_cagrilabilir_fl          Int      @default(0)
  proje_kod                    String   @default("1") @map("sip_projekodu")
  sip_SpecRECno                Int      @default(0)
  sip_iptal                    Int      @default(0)
  sip_fileid                   Int      @default(21)
  sip_hidden                   Int      @default(0)
  sip_kilitli                  Int      @default(0)
  sip_degisti                  Int      @default(0)
  sip_checksum                 Int      @default(0)
  sip_lastup_date              DateTime @default(now()) @db.DateTime
  sip_special1                 String   @default("")
  sip_special2                 String   @default("")
  sip_special3                 String   @default("")
  sip_firmano                  Int      @default(0)
  sip_subeno                   Int      @default(0)
  sip_tip                      Int      @default(0)
  sip_cins                     Int      @default(0)
  sip_belgeno                  String   @default("")
  sip_birim_pntr               Int      @default(1)
  sip_iskonto_2                Float    @default(0)
  sip_iskonto_3                Float    @default(0)
  sip_iskonto_4                Float    @default(0)
  sip_iskonto_5                Float    @default(0)
  sip_iskonto_6                Float    @default(0)
  sip_masraf_1                 Float    @default(0)
  sip_masraf_2                 Float    @default(0)
  sip_masraf_3                 Float    @default(0)
  sip_masraf_4                 Float    @default(0)
  sip_vergi_pntr               Int      @default(8)
  sip_masvergi_pntr            Int      @default(0)
  sip_masvergi                 Float    @default(0)
  sip_aciklama2                String   @default("")
  sip_vergisiz_fl              Int      @default(0)
  sip_kapat_fl                 Int      @default(0)
  sip_promosyon_fl             Int      @default(0)
  sip_cari_sormerk             String   @default("")
  sip_stok_sormerk             String   @default("")
  sip_cari_grupno              Int      @default(0)
  sip_adresno                  Int      @default(1)
  sip_teslimturu               String   @default("")
  sip_prosip_uid               String   @default("00000000-0000-0000-0000-000000000000")
  sip_iskonto1                 Int      @default(0)
  sip_iskonto2                 Int      @default(1)
  sip_iskonto3                 Int      @default(1)
  sip_iskonto4                 Int      @default(1)
  sip_iskonto5                 Int      @default(1)
  sip_iskonto6                 Int      @default(1)
  sip_masraf1                  Int      @default(1)
  sip_masraf2                  Int      @default(1)
  sip_masraf3                  Int      @default(1)
  sip_masraf4                  Int      @default(1)
  sip_isk1                     Int      @default(0)
  sip_isk2                     Int      @default(0)
  sip_isk3                     Int      @default(0)
  sip_isk4                     Int      @default(0)
  sip_isk5                     Int      @default(0)
  sip_isk6                     Int      @default(0)
  sip_mas1                     Int      @default(0)
  sip_mas2                     Int      @default(0)
  sip_mas3                     Int      @default(0)
  sip_mas4                     Int      @default(0)
  sip_Exp_Imp_Kodu             String   @default("")
  sip_kar_orani                Float    @default(0)
  sip_stal_uid                 String   @default("00000000-0000-0000-0000-000000000000")
  sip_planlananmiktar          Float    @default(0)
  sip_teklif_uid               String   @default("00000000-0000-0000-0000-000000000000")
  sip_parti_kodu               String   @default("")
  sip_lot_no                   Int      @default(0)
  sip_fiyat_liste_no           Int      @default(0)
  sip_Otv_Pntr                 Int      @default(0)
  sip_Otv_Vergi                Float    @default(0)
  sip_otvtutari                Float    @default(0)
  sip_OtvVergisiz_Fl           Int      @default(0)
  sip_paket_kod                String   @default("")
  sip_Rez_uid                  String   @default("00000000-0000-0000-0000-000000000000")
  sip_harekettipi              Int      @default(0)
  sip_yetkili_uid              String   @default("00000000-0000-0000-0000-000000000000")
  sip_kapatmanedenkod          String   @default("")
  sip_gecerlilik_tarihi        DateTime @default("1899-12-30T00:00:00.00Z") @db.DateTime
  sip_onodeme_evrak_tip        Int      @default(0)
  sip_onodeme_evrak_seri       String   @default("")
  sip_onodeme_evrak_sira       Int      @default(0)
  sip_rezervasyon_miktari      Float    @default(0)
  sip_rezerveden_teslim_edilen Float    @default(0)
  sip_HareketGrupKodu1         String   @default("")
  sip_HareketGrupKodu2         String   @default("")
  sip_HareketGrupKodu3         String   @default("")
  sip_Olcu1                    Float    @default(0)
  sip_Olcu2                    Float    @default(0)
  sip_Olcu3                    Float    @default(0)
  sip_Olcu4                    Float    @default(0)
  sip_Olcu5                    Float    @default(0)
  sip_FormulMiktarNo           Int      @default(0)
  sip_FormulMiktar             Float    @default(0)
  sip_satis_fiyat_doviz_cinsi  Int      @default(0)
  sip_satis_fiyat_doviz_kuru   Float    @default(0)
  sip_eticaret_kanal_kodu      String   @default("")

  stok    Stok        @relation(fields: [stok_kod], references: [kod])
  cari    Cari        @relation(fields: [cari_kod], references: [kod])
  siparis SiparisOzet @relation(fields: [evrak_seri, evrak_sira, tarih], references: [evrak_seri, evrak_sira, tarih])

  @@map("SIPARISLER")
}

model Aciklama {
  id                       String   @id @map("egk_Guid")
  olusturan_kod            Int      @map("egk_create_user")
  lastup_user              Int      @map("egk_lastup_user")
  evrak_seri               String   @map("egk_evr_seri")
  evrak_sira               Int      @map("egk_evr_sira")
  satir1                   String   @default("") @map("egk_evracik1")
  satir2                   String   @default("") @map("egk_evracik2")
  satir3                   String   @default("") @map("egk_evracik3")
  satir4                   String   @default("") @map("egk_evracik4")
  satir5                   String   @default("") @map("egk_evracik5")
  satir6                   String   @default("") @map("egk_evracik6")
  satir7                   String   @default("") @map("egk_evracik7")
  satir8                   String   @default("") @map("egk_evracik8")
  satir9                   String   @default("") @map("egk_evracik9")
  satir10                  String   @default("") @map("egk_evracik10")
  egk_SpecRECno            Int      @default(0)
  egk_iptal                Int      @default(0)
  egk_fileid               Int      @default(66)
  egk_hidden               Int      @default(0)
  egk_kilitli              Int      @default(0)
  egk_degisti              Int      @default(0)
  egk_checksum             Int      @default(0)
  egk_lastup_date          DateTime @default(now()) @db.DateTime
  egk_special1             String   @default("")
  egk_special2             String   @default("")
  egk_special3             String   @default("")
  egk_dosyano              Int      @default(21)
  egk_hareket_tip          Int      @default(0)
  egk_evr_tip              Int      @default(0)
  egk_evr_ustkod           String   @default("")
  egk_evr_doksayisi        Int      @default(0)
  egk_sipgenkarorani       Int      @default(0)
  egk_kargokodu            String   @default("")
  egk_kargono              String   @default("")
  egk_tesaltarihi          DateTime @default("1899-12-30T00:00:00.00Z") @db.DateTime
  egk_tesalkisi            String   @default("")
  egk_prevwiewsayisi       Int      @default(0)
  egk_emailsayisi          Int      @default(0)
  egk_Evrakopno_verildi_fl Int      @default(0)

  evrak SiparisOzet @relation(fields: [evrak_seri, evrak_sira, egk_dosyano], references: [evrak_seri, evrak_sira, fileId])

  @@unique([evrak_seri, evrak_sira, egk_dosyano])
  @@map("EVRAK_ACIKLAMALARI")
}
